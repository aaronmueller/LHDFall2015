<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">

  <head>
    <title>Bullet Hello World - Panda3D Manual</title>
    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="stylesheet" href="style.css" type="text/css"><link rel="shortcut icon" href="favicon.ico">    <meta name="keywords" content="Panda3D, Panda, 3D, Python, graphics, free, game, engine, game rendering engine, simulation, open source, free download, Disney, ETC, Entertainment Technology Center, open-source">
    <meta name="description" content="Free open source 3D game and simulation engine developed by Disney and maintained by Carnegie Mellon University\'s Entertainment Technology Center">
    </head>
    <body>
<table width=960 cellpadding=0 cellspacing=0 id=main align=center>
<tr>
<td id=borderleft></td>
<td id=maincenter valign=top>
<tr><td id=pcontent valign=top><h2>Panda3D Manual: Bullet Hello World</h2>
<div style="width:100%; padding: 1px;" class=subnavigation>
<table width="640px" cellpadding="0" cellspacing="0" border="0">
              <tr>
              <td width="70px" align="left">&nbsp;&nbsp;<a style="text-decoration:none" href="Using_Bullet_with_Panda3D.html"><img border=0 width=16 height=16 src="arrow_left.png" align=absmiddle> <u>Prev</u></a></td>
              <td width="70px" align="center"><a style="text-decoration:none" href="Main_Page.html"><img border=0 width=16 height=16 src="arrow_up.png" align=absmiddle><u>Top</u></a></td>
              <td width="70px" align="right"><a style="text-decoration:none" href="Bullet_Debug_Renderer.html"><u>Next</u> <img border=0 width=16 height=16 src="arrow_right.png" align=absmiddle></a>&nbsp;&nbsp;</td>
              </tr></table></div><div class='wikicontent' id='wikicontentid'><p>This page intends to lead through a minimal "hello world" program using Panda3D and Bullet physics.
</p><p>
</p>
<table id="toc" class="toc"><tr><td><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="Bullet_Hello_World.html#Compiling_C.2B.2B_Panda3D_with_Bullet_code"><span class="tocnumber">1</span> <span class="toctext">Compiling C++ Panda3D with Bullet code</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="Bullet_Hello_World.html#World"><span class="tocnumber">2</span> <span class="toctext">World</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="Bullet_Hello_World.html#Static_bodies"><span class="tocnumber">3</span> <span class="toctext">Static bodies</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="Bullet_Hello_World.html#Dynamic_bodies"><span class="tocnumber">4</span> <span class="toctext">Dynamic bodies</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="Bullet_Hello_World.html#The_Program"><span class="tocnumber">5</span> <span class="toctext">The Program</span></a></li>
</ul>
</td></tr></table>
<h2> <span class="mw-headline" id="Compiling_C.2B.2B_Panda3D_with_Bullet_code">Compiling C++ Panda3D with Bullet code</span></h2>
<p>Above all, we have to know how to compile C++ code using Panda3D binding to Bullet Engine, that can be done following a few steps.
</p>
<ul><li> Download BulletPhysics SDK (sources or binaries): <a rel="nofollow" class="external free" href="http://code.google.com/p/bullet/downloads/list">http://code.google.com/p/bullet/downloads/list</a>, and if apply, compile it, (Docs on <a rel="nofollow" class="external free" href="http://bulletphysics.org/mediawiki-1.5.8/index.php/Main_Page">http://bulletphysics.org/mediawiki-1.5.8/index.php/Main_Page</a>). 
</li><li> Locate libraries and included files, normally '/usr/local/include/bullet' on Linux distros, 'pkg-config bullet --libs' and 'pkg-config bullet --cflags' may work. On Windows or MacOS I'm not sure where the libraries are but may not be difficult to locate.
</li><li> Compile and linking it's easy, just follow CXX File manual's paragraph and add -Iyour_include_bullet_folder and -llibs (-lBulletSoftBody -lBulletDynamics -lBulletCollision -lLinearMath).
</li><li> If you're using an IDE (such VS 2008 or Netbeans), just add libraries and header files to proyect properties (see manual of your IDE). 
</li></ul>
<p>And then, we are ready to compile our Bullet + Panda3D Code.

</p>
<h2> <span class="mw-headline" id="World">World</span></h2>
<p>In order to use Bullet physics we need to have a BulletWorld. The world is Panda3D's term for a <i>"space"</i> or <i>"scene"</i>. The world holds physical objects like rigid bodies, soft bodies or character controllers. It controls global parameters, such a gravity, and it advances the simulation state.
</p>

<p>
First, include Panda3D bullet binding headers.
</p>
<pre class="cpp"><span style="color: #339900;">#include &quot;panda3d/bulletWorld.h&quot;</span><br /><span style="color: #339900;">#include &quot;panda3d/bulletPlaneShape.h&quot;</span><br /><span style="color: #339900;">#include &quot;panda3d/bulletBoxShape.h&quot;</span><br />...<br /><span style="color: #000000;">BulletWorld</span> <span style="color: #000040;">*</span>physics_world<span style="color: #008080;">;</span><br />physics_world <span style="color: #000080;">=</span> <span style="color: #0000dd;">new</span> BulletWorld<span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span><br />physics_world<span style="color: #000040;">-</span><span style="color: #000080;">&gt;</span>set_gravity<span style="color: #008000;">&#40;</span><span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">-9.8</span><span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span><br />...</pre>
<p>
</p><p>The above code creates a new world, and it sets the worlds gravity to a downward vector with length 9.81. While Bullet is in theory independent from any particular units it is recommended to stick with SI units (kilogram, meter, second). In SI units 9.81 m/sÂ² is the gravity on Earth's surface.
</p><p>Next we need to advance the simulation state. This is best done by a task which gets called each frame. We find out about the elapsed time (dt), and pass this value to the <code>do_physics</code> method.
</p>

<p>
</p>
<pre class="cpp">...<br /><span style="color: #000000;">AsyncTask</span><span style="color: #008080;">::</span><span style="color: #000000;">DoneStatus</span> update_scene<span style="color: #008000;">&#40;</span>GenericAsyncTask<span style="color: #000040;">*</span> task, <span style="color: #0000ff;">void</span><span style="color: #000040;">*</span> data<span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span><br />    <span style="color: #666666;">// Get dt (from Python example) and apply to do_physics(float, int, int);</span><br />    ClockObject <span style="color: #000040;">*</span>co <span style="color: #000080;">=</span> ClockObject<span style="color: #008080;">::</span><span style="color: #000000;">get_global_clock</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span><br />    physics_world<span style="color: #000040;">-</span><span style="color: #000080;">&gt;</span>do_physics<span style="color: #008000;">&#40;</span>co<span style="color: #000040;">-</span><span style="color: #000080;">&gt;</span>get_dt<span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span>, <span style="color: #0000dd;">10</span>, <span style="color: #0000dd;">1.0</span> <span style="color: #000040;">/</span> <span style="color: #0000dd;">180.0</span><span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span><br />&#160;<br />    <span style="color: #0000ff;">return</span> AsyncTask<span style="color: #008080;">::</span><span style="color: #000000;">DS_cont</span><span style="color: #008080;">;</span><br /><span style="color: #008000;">&#125;</span><br />...<br /><span style="color: #000000;">PT</span><span style="color: #008000;">&#40;</span>GenericAsyncTask<span style="color: #008000;">&#41;</span> task<span style="color: #008080;">;</span><br />task <span style="color: #000080;">=</span> <span style="color: #0000dd;">new</span> GenericAsyncTask<span style="color: #008000;">&#40;</span><span style="color: #FF0000;">&quot;Scene update&quot;</span>, <span style="color: #000040;">&amp;</span>update_scene, <span style="color: #008000;">&#40;</span><span style="color: #0000ff;">void</span><span style="color: #000040;">*</span><span style="color: #008000;">&#41;</span> <span style="color: #0000ff;">NULL</span><span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span><br />task_mgr<span style="color: #000040;">-</span><span style="color: #000080;">&gt;</span>add<span style="color: #008000;">&#40;</span>task<span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span> <span style="color: #666666;">// Note: task_mgr = AsyncTaskManager::get_global_ptr();</span><br />...</pre>
<p>
</p><p>The <code>doPhysics</code> method allows finer control on the way the simulation state is advanced. Internally Bullet splits a timestep into several substeps. We can pass a maximum number of substeps and the size of each substep, like show in the following code.
</p>

<pre class="cpp">physics_world<span style="color: #000040;">-</span><span style="color: #000080;">&gt;</span>do_physics<span style="color: #008000;">&#40;</span>co<span style="color: #000040;">-</span><span style="color: #000080;">&gt;</span>get_dt<span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span>, <span style="color: #0000dd;">10</span>, <span style="color: #0000dd;">1.0</span> <span style="color: #000040;">/</span> <span style="color: #0000dd;">180.0</span><span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span></pre>
<p>Here we have a maximum of 10 substeps, each with 1/180 seconds. Choosing smaller substeps will make the simulation more realistic, but performance will decrease too. Smaller substeps also reduce jitter.
</p><p><br />
</p>
<h2> <span class="mw-headline" id="Static_bodies">Static bodies</span></h2>
<p>So far we just have an empty world. We next need to add some objects. The most simple objects are static bodies. Static object don't change their position or orientation with time. Typical static objects are the ground or terrain, and houses or other non-moveable obstacles. Here we create a simple plane which will serve as a ground.
</p>

<pre class="cpp">...<br /><span style="color: #000000;">BulletPlaneShape</span> <span style="color: #000040;">*</span>floor_shape <span style="color: #000080;">=</span> <span style="color: #0000dd;">new</span> BulletPlaneShape<span style="color: #008000;">&#40;</span>LVecBase3f<span style="color: #008000;">&#40;</span><span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">1</span><span style="color: #008000;">&#41;</span>, <span style="color: #0000dd;">1</span><span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span><br />BulletRigidBodyNode <span style="color: #000040;">*</span>floor_rigid_node <span style="color: #000080;">=</span> <span style="color: #0000dd;">new</span> BulletRigidBodyNode<span style="color: #008000;">&#40;</span><span style="color: #FF0000;">&quot;Ground&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span><br />&#160;<br />floor_rigid_node<span style="color: #000040;">-</span><span style="color: #000080;">&gt;</span>add_shape<span style="color: #008000;">&#40;</span>floor_shape<span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span><br />&#160;<br />NodePath np_ground <span style="color: #000080;">=</span> window<span style="color: #000040;">-</span><span style="color: #000080;">&gt;</span>get_render<span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span>.<span style="color: #000000;">attach_new_node</span><span style="color: #008000;">&#40;</span>floor_rigid_node<span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span><br />np_ground.<span style="color: #000000;">set_pos</span><span style="color: #008000;">&#40;</span><span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">-2</span><span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span><br />physics_world<span style="color: #000040;">-</span><span style="color: #000080;">&gt;</span>attach_rigid_body<span style="color: #008000;">&#40;</span>floor_rigid_node<span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span><br />...</pre>
<p>First we create a collision shape, in the case a <code>BulletPlaneShape</code>. We pass the plane's constant and normal vector within the shape's constructor. There is a separate page about setting up the various collision shapes offered by Bullet, so we won't go into more detail here.
</p><p>Next we create a rigid body and add the previously created shape. <code>BulletRigidBodyNode</code> is derived from <code>PandaNode</code>, and thus the rigid body can be placed within the Panda3D scene graph. you can also use methods like <code>setPos</code> or &lt;/code&gt;setH&lt;/code&gt; to place the rigid body node where you want it to be.
</p><p>Finally we need to attach the newly created rigid body node to the world. Only rigid bodies attached to the world will be considered when advancing the simulation state.
</p><p><br />
</p>
<h2> <span class="mw-headline" id="Dynamic_bodies">Dynamic bodies</span></h2>
<p>Dynamic bodies are similar to static bodies. Except that dynamic bodies can be moved around the world by applying force or torque. To setup a dynamic body is almost the same as for static bodies. We will have to set one additional property though, the body's mass. Setting a positive finite mass will create a dynamic body, while setting the mass to zero will create a static body. Zero mass is a convention for setting an <i>infinite</i> mass, which is the same as making the body unmovable (static). 
</p>

<p>
</p>
<pre class="cpp">...<br /><span style="color: #000000;">BulletBoxShape</span> <span style="color: #000040;">*</span>box_shape <span style="color: #000080;">=</span> <span style="color: #0000dd;">new</span> BulletBoxShape<span style="color: #008000;">&#40;</span><span style="color: #000040;">*</span><span style="color: #0000dd;">new</span> LVecBase3f<span style="color: #008000;">&#40;</span><span style="color: #0000dd;">0.5</span>, <span style="color: #0000dd;">0.5</span>, <span style="color: #0000dd;">0.5</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span><br />BulletRigidBodyNode <span style="color: #000040;">*</span>box_rigid_node <span style="color: #000080;">=</span> <span style="color: #0000dd;">new</span> BulletRigidBodyNode<span style="color: #008000;">&#40;</span><span style="color: #FF0000;">&quot;Box&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span><br />&#160;<br />box_rigid_node<span style="color: #000040;">-</span><span style="color: #000080;">&gt;</span>set_mass<span style="color: #008000;">&#40;</span><span style="color: #0000dd;">1.0</span><span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span> <span style="color: #666666;">// Gravity affects this rigid node.</span><br />box_rigid_node<span style="color: #000040;">-</span><span style="color: #000080;">&gt;</span>add_shape<span style="color: #008000;">&#40;</span>box_shape<span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span><br />&#160;<br />NodePath np_box <span style="color: #000080;">=</span> window<span style="color: #000040;">-</span><span style="color: #000080;">&gt;</span>get_render<span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span>.<span style="color: #000000;">attach_new_node</span><span style="color: #008000;">&#40;</span>box_rigid_node<span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span><br />np_box.<span style="color: #000000;">set_pos</span><span style="color: #008000;">&#40;</span><span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">2</span><span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span><br />physics_world<span style="color: #000040;">-</span><span style="color: #000080;">&gt;</span>attach_rigid_body<span style="color: #008000;">&#40;</span>box_rigid_node<span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span><br />...</pre>
<p>
</p><p>Bullet will automatically update a rigid body node's position and orientation if is has changed after advancing the simulation state. So, if you have a <code>GeomNode</code> - e. g. a textured box - and reparent this geom node below the rigid body node, then the geom node will move around together with the rigid body. You don't have to synchronize the visual world with the physics world.
</p><p><br />
</p>
<h2> <span class="mw-headline" id="The_Program">The Program</span></h2>
<p>Let's put everything learned on this page together into a single script, which is shown below. It assumes that you have an .egg model of a 1 by 1 by 1 box.
</p><p>when running the script you will see a box falling down onto an invisible plane. The plane is invisible simply because we didn't parent a visual mode below the plane's rigid body node. Of course we could have done so. 
</p><p>The model cube.egg used in this hello word sample can be found in the following archive: <a rel="nofollow" class="external free" href="http://enn0x.p3dp.com/bullet-samples.zip">http://enn0x.p3dp.com/bullet-samples.zip</a> NOTE: Samples are currently available in Python code only. 
</p><p><br />
</p>

<p>
</p>
<pre class="cpp"><span style="color: #666666;">// Bullet Physics Example.</span><br /><span style="color: #666666;">// The following example is done from Python sources, Panda Reference and Panda Manual,</span><br /><span style="color: #666666;">// for more information, visit Panda3D and/or Bullet physics web site.</span><br />&#160;<br /><span style="color: #666666;">// Compiling and Linking documentation and notes are not </span><br /><span style="color: #666666;">// covered in this file, check manual for more information.</span><br />&#160;<br /><span style="color: #339900;">#include &quot;panda3d/pandaFramework.h&quot;</span><br /><span style="color: #339900;">#include &quot;panda3d/windowFramework.h&quot;</span><br /><span style="color: #339900;">#include &quot;panda3d/nodePath.h&quot;</span><br /><span style="color: #339900;">#include &quot;panda3d/clockObject.h&quot;</span><br />&#160;<br /><span style="color: #339900;">#include &quot;panda3d/asyncTask.h&quot;</span><br /><span style="color: #339900;">#include &quot;panda3d/genericAsyncTask.h&quot;</span><br />&#160;<br /><span style="color: #339900;">#include &quot;panda3d/bulletWorld.h&quot;</span><br /><span style="color: #339900;">#include &quot;panda3d/bulletPlaneShape.h&quot;</span><br /><span style="color: #339900;">#include &quot;panda3d/bulletBoxShape.h&quot;</span><br />&#160;<br />BulletWorld <span style="color: #000040;">*</span>get_physics_world<span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span><br />    <span style="color: #666666;">// physics_world is supposed to be an global variable,</span><br />    <span style="color: #666666;">// but declaring global variables is not cool</span><br />    <span style="color: #666666;">// for good programmers lol, instead, should use static keyword.</span><br />    <span style="color: #0000ff;">static</span> BulletWorld <span style="color: #000040;">*</span>physics_world <span style="color: #000080;">=</span> <span style="color: #0000dd;">new</span> BulletWorld<span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span><br />    <span style="color: #0000ff;">return</span> physics_world<span style="color: #008080;">;</span><br /><span style="color: #008000;">&#125;</span><br />&#160;<br />AsyncTask<span style="color: #008080;">::</span><span style="color: #000000;">DoneStatus</span> update_scene<span style="color: #008000;">&#40;</span>GenericAsyncTask<span style="color: #000040;">*</span> task, <span style="color: #0000ff;">void</span><span style="color: #000040;">*</span> data<span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span><br />    <span style="color: #666666;">// Get dt (from Python example) and apply to do_physics(float, int, int);</span><br />    ClockObject <span style="color: #000040;">*</span>co <span style="color: #000080;">=</span> ClockObject<span style="color: #008080;">::</span><span style="color: #000000;">get_global_clock</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span><br />    get_physics_world<span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #000040;">-</span><span style="color: #000080;">&gt;</span>do_physics<span style="color: #008000;">&#40;</span>co<span style="color: #000040;">-</span><span style="color: #000080;">&gt;</span>get_dt<span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span>, <span style="color: #0000dd;">10</span>, <span style="color: #0000dd;">1.0</span> <span style="color: #000040;">/</span> <span style="color: #0000dd;">180.0</span><span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span><br />&#160;<br />    <span style="color: #0000ff;">return</span> AsyncTask<span style="color: #008080;">::</span><span style="color: #000000;">DS_cont</span><span style="color: #008080;">;</span><br /><span style="color: #008000;">&#125;</span><br />&#160;<br /><span style="color: #0000ff;">int</span> main<span style="color: #008000;">&#40;</span><span style="color: #0000ff;">int</span> argc, <span style="color: #0000ff;">char</span> <span style="color: #000040;">*</span>argv<span style="color: #008000;">&#91;</span><span style="color: #008000;">&#93;</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span><br />    <span style="color: #666666;">// All variables.</span><br />    PandaFramework framework<span style="color: #008080;">;</span><br />    WindowFramework <span style="color: #000040;">*</span>window<span style="color: #008080;">;</span><br />    NodePath camera<span style="color: #008080;">;</span><br />    PT<span style="color: #008000;">&#40;</span>AsyncTaskManager<span style="color: #008000;">&#41;</span> task_mgr<span style="color: #008080;">;</span><br />&#160;<br />    <span style="color: #666666;">// Init everything&#160;:D</span><br />    framework.<span style="color: #000000;">open_framework</span><span style="color: #008000;">&#40;</span>argc, argv<span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span><br />    framework.<span style="color: #000000;">set_window_title</span><span style="color: #008000;">&#40;</span><span style="color: #FF0000;">&quot;Bullet Physics&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span><br />&#160;<br />    window <span style="color: #000080;">=</span> framework.<span style="color: #000000;">open_window</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span><br />    window<span style="color: #000040;">-</span><span style="color: #000080;">&gt;</span>enable_keyboard<span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span><br />    window<span style="color: #000040;">-</span><span style="color: #000080;">&gt;</span>setup_trackball<span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span><br />&#160;<br />    camera <span style="color: #000080;">=</span> window<span style="color: #000040;">-</span><span style="color: #000080;">&gt;</span>get_camera_group<span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span><br />    task_mgr <span style="color: #000080;">=</span> AsyncTaskManager<span style="color: #008080;">::</span><span style="color: #000000;">get_global_ptr</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span><br />&#160;<br />    <span style="color: #666666;">// Make physics simulation.</span><br />    <span style="color: #666666;">// Static world stuff.</span><br />    get_physics_world<span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #000040;">-</span><span style="color: #000080;">&gt;</span>set_gravity<span style="color: #008000;">&#40;</span><span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">-9.8</span><span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span><br />&#160;<br />    BulletPlaneShape <span style="color: #000040;">*</span>floor_shape <span style="color: #000080;">=</span> <span style="color: #0000dd;">new</span> BulletPlaneShape<span style="color: #008000;">&#40;</span><span style="color: #000040;">*</span><span style="color: #0000dd;">new</span> LVecBase3f<span style="color: #008000;">&#40;</span><span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">1</span><span style="color: #008000;">&#41;</span>, <span style="color: #0000dd;">1</span><span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span><br />    BulletRigidBodyNode <span style="color: #000040;">*</span>floor_rigid_node <span style="color: #000080;">=</span> <span style="color: #0000dd;">new</span> BulletRigidBodyNode<span style="color: #008000;">&#40;</span><span style="color: #FF0000;">&quot;Ground&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span><br />&#160;<br />    floor_rigid_node<span style="color: #000040;">-</span><span style="color: #000080;">&gt;</span>add_shape<span style="color: #008000;">&#40;</span>floor_shape<span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span><br />&#160;<br />    NodePath np_ground <span style="color: #000080;">=</span> window<span style="color: #000040;">-</span><span style="color: #000080;">&gt;</span>get_render<span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span>.<span style="color: #000000;">attach_new_node</span><span style="color: #008000;">&#40;</span>floor_rigid_node<span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span><br />    np_ground.<span style="color: #000000;">set_pos</span><span style="color: #008000;">&#40;</span><span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">-2</span><span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span><br />    get_physics_world<span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #000040;">-</span><span style="color: #000080;">&gt;</span>attach_rigid_body<span style="color: #008000;">&#40;</span>floor_rigid_node<span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span><br />&#160;<br />    <span style="color: #666666;">// Dynamic world stuff.</span><br />    BulletBoxShape <span style="color: #000040;">*</span>box_shape <span style="color: #000080;">=</span> <span style="color: #0000dd;">new</span> BulletBoxShape<span style="color: #008000;">&#40;</span><span style="color: #000040;">*</span><span style="color: #0000dd;">new</span> LVecBase3f<span style="color: #008000;">&#40;</span><span style="color: #0000dd;">0.5</span>, <span style="color: #0000dd;">0.5</span>, <span style="color: #0000dd;">0.5</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span><br />    BulletRigidBodyNode <span style="color: #000040;">*</span>box_rigid_node <span style="color: #000080;">=</span> <span style="color: #0000dd;">new</span> BulletRigidBodyNode<span style="color: #008000;">&#40;</span><span style="color: #FF0000;">&quot;Box&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span><br />&#160;<br />    box_rigid_node<span style="color: #000040;">-</span><span style="color: #000080;">&gt;</span>set_mass<span style="color: #008000;">&#40;</span><span style="color: #0000dd;">1.0</span><span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span> <span style="color: #666666;">// Gravity affects this rigid node.</span><br />    box_rigid_node<span style="color: #000040;">-</span><span style="color: #000080;">&gt;</span>add_shape<span style="color: #008000;">&#40;</span>box_shape<span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span><br />&#160;<br />    NodePath np_box <span style="color: #000080;">=</span> window<span style="color: #000040;">-</span><span style="color: #000080;">&gt;</span>get_render<span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span>.<span style="color: #000000;">attach_new_node</span><span style="color: #008000;">&#40;</span>box_rigid_node<span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span><br />    np_box.<span style="color: #000000;">set_pos</span><span style="color: #008000;">&#40;</span><span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">2</span><span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span><br />    get_physics_world<span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #000040;">-</span><span style="color: #000080;">&gt;</span>attach_rigid_body<span style="color: #008000;">&#40;</span>box_rigid_node<span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span><br />&#160;<br />    NodePath np_box_model <span style="color: #000080;">=</span> window<span style="color: #000040;">-</span><span style="color: #000080;">&gt;</span>load_model<span style="color: #008000;">&#40;</span>framework.<span style="color: #000000;">get_models</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span>, <span style="color: #FF0000;">&quot;models/box&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span><br />    np_box_model.<span style="color: #000000;">set_pos</span><span style="color: #008000;">&#40;</span><span style="color: #0000dd;">-0.5</span>,<span style="color: #0000dd;">-0.5</span>,<span style="color: #0000dd;">-0.5</span><span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span><br />    np_box.<span style="color: #000000;">flatten_light</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span><br />    np_box_model.<span style="color: #000000;">reparent_to</span><span style="color: #008000;">&#40;</span>np_box<span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span><br />&#160;<br />    PT<span style="color: #008000;">&#40;</span>GenericAsyncTask<span style="color: #008000;">&#41;</span> task<span style="color: #008080;">;</span><br />    task <span style="color: #000080;">=</span> <span style="color: #0000dd;">new</span> GenericAsyncTask<span style="color: #008000;">&#40;</span><span style="color: #FF0000;">&quot;Scene update&quot;</span>, <span style="color: #000040;">&amp;</span>update_scene, <span style="color: #008000;">&#40;</span><span style="color: #0000ff;">void</span><span style="color: #000040;">*</span><span style="color: #008000;">&#41;</span> <span style="color: #0000ff;">NULL</span><span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span><br />    task_mgr<span style="color: #000040;">-</span><span style="color: #000080;">&gt;</span>add<span style="color: #008000;">&#40;</span>task<span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span><br />&#160;<br />    framework.<span style="color: #000000;">main_loop</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span><br />    framework.<span style="color: #000000;">close_framework</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span><br />&#160;<br />    <span style="color: #0000ff;">return</span> <span style="color: #008000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span><br /><span style="color: #008000;">&#125;</span></pre>

<!-- 
NewPP limit report
Preprocessor node count: 187/1000000
Post-expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Expensive parser function count: 0/100
-->

<!-- Saved in parser cache with key mw_manual:pcache:idhash:2606-0!*!*!!en!*!* and timestamp 20130413100851 -->
</div><div style="width:100%; padding: 1px;" class=subnavigation>
<table width="640px" cellpadding="0" cellspacing="0" border="0">
              <tr>
              <td width="70px" align="left">&nbsp;&nbsp;<a style="text-decoration:none" href="Using_Bullet_with_Panda3D.html"><img border=0 width=16 height=16 src="arrow_left.png" align=absmiddle> <u>Prev</u></a></td>
              <td width="70px" align="center"><a style="text-decoration:none" href="Main_Page.html"><img border=0 width=16 height=16 src="arrow_up.png" align=absmiddle><u>Top</u></a></td>
              <td width="70px" align="right"><a style="text-decoration:none" href="Bullet_Debug_Renderer.html"><u>Next</u> <img border=0 width=16 height=16 src="arrow_right.png" align=absmiddle></a>&nbsp;&nbsp;</td>
              </tr></table></div><div id=legal>&copy; Carnegie Mellon University 2010</div></td></tr></table></td><td id=borderright></td></tr></table></td><td id=borderright></td></tr></table></body></html>
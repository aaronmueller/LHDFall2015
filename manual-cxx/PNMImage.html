<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">

  <head>
    <title>Creating New Textures from Scratch - Panda3D Manual</title>
    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="stylesheet" href="style.css" type="text/css"><link rel="shortcut icon" href="favicon.ico">    <meta name="keywords" content="Panda3D, Panda, 3D, Python, graphics, free, game, engine, game rendering engine, simulation, open source, free download, Disney, ETC, Entertainment Technology Center, open-source">
    <meta name="description" content="Free open source 3D game and simulation engine developed by Disney and maintained by Carnegie Mellon University\'s Entertainment Technology Center">
    </head>
    <body>
<table width=960 cellpadding=0 cellspacing=0 id=main align=center>
<tr>
<td id=borderleft></td>
<td id=maincenter valign=top>
<tr><td id=pcontent valign=top><h2>Panda3D Manual: Creating New Textures from Scratch</h2>
<div style="width:100%; padding: 1px;" class=subnavigation>
<table width="640px" cellpadding="0" cellspacing="0" border="0">
              <tr>
              <td width="70px" align="left">&nbsp;&nbsp;<a style="text-decoration:none" href="More_about_GeomVertexReader,_GeomVertexWriter,_and_GeomVertexRewriter.html"><img border=0 width=16 height=16 src="arrow_left.png" align=absmiddle> <u>Prev</u></a></td>
              <td width="70px" align="center"><a style="text-decoration:none" href="Main_Page.html"><img border=0 width=16 height=16 src="arrow_up.png" align=absmiddle><u>Top</u></a></td>
              <td width="70px" align="right"><a style="text-decoration:none" href="Writing_3D_Models_out_to_Disk.html"><u>Next</u> <img border=0 width=16 height=16 src="arrow_right.png" align=absmiddle></a>&nbsp;&nbsp;</td>
              </tr></table></div><div class='wikicontent' id='wikicontentid'><h2> <span class="mw-headline" id="The_PNMImage_Class">The PNMImage Class</span></h2>
<p>This class is how Panda3D handles regular images (.gif, .jpg, and the like). This class allows you to manipulate individual pixels of the image. You can load existing images using the function <code>read(fileName)</code> where <code>filename</code> is the path to the image file (in <a href="Panda_Filename_Syntax.html" title="Panda Filename Syntax" class="mw-redirect">Panda Filename Syntax</a>) wrapped in a <code>Filename </code> object. Or, you can create a brand new image from scratch, by passing the x, y size to the constructor.

</p>
<pre class="cpp">PNMImage myImage<span style="color: #008080;">;</span><br />myImage.<span style="color: #000000;">read</span><span style="color: #008000;">&#40;</span>Filename<span style="color: #008000;">&#40;</span><span style="color: #FF0000;">&quot;testImg.png&quot;</span><span style="color: #008000;">&#41;</span>,PNMFileTypeRegistry<span style="color: #008080;">::</span><span style="color: #000000;">get_global_ptr</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #000040;">-</span><span style="color: #000080;">&gt;</span>get_type_from_extension<span style="color: #008000;">&#40;</span><span style="color: #FF0000;">&quot;png&quot;</span><span style="color: #008000;">&#41;</span>,<span style="color: #0000ff;">true</span><span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span></pre>
<p>You can get the size of the image you have read using the <code>getXSize()</code> and <code>getYSize()</code> functions.  Although you cannot change the size of an image directly, you can rescale an image by filtering it into a larger or smaller PNMImage:
</p>
<pre class="python">fullSize = PNMImage<span style="color: black;">&#40;</span>Filename<span style="color: black;">&#40;</span><span style="color: #483d8b;">&quot;testImg.png&quot;</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span><br />reduced = PNMImage<span style="color: black;">&#40;</span><span style="color: #ff4500;">256</span>, <span style="color: #ff4500;">256</span><span style="color: black;">&#41;</span><br />reduced.<span style="color: black;">gaussianFilterFrom</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">1.0</span>, fullSize<span style="color: black;">&#41;</span></pre>
<p>You can get individual RGB values using the <code>getRed(x,y), getGreen(x,y), getBlue(x,y)</code> or <code>getRedVal(x,y), getGreenVal(x,y), getBlueVal(x,y)</code> where x and y tell what pixel to look at  (lower-left is 0,0 upper right is <code>getXSize()-1, getYSize()-1</code> The difference between these functions is that the <code>get*Val</code> functions return a number between 0 and 1 while the <code>get*</code> functions return their value as an integer. For example, if your image uses 8-bit color calling <code>getGreenVal</code> on a green pixel will return 255 and calling <code>getGreen</code> will return 1. You can also get all the RGB information at the same time using <code>getXel(x,y)</code> and <code>getXelVal(x,y)</code> which return a 3 component vector with red in the x, green in the y, and blue in the z.
</p>
<pre class="python"><span style="color: #808080; font-style: italic;"># The pixel at 0,0 is red and we're using 8-bit color</span><br />myImage.<span style="color: black;">getRedVal</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">0</span>,<span style="color: #ff4500;">0</span><span style="color: black;">&#41;</span> <span style="color: #808080; font-style: italic;"># Returns 255</span><br />myImage.<span style="color: black;">getRed</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">0</span>,<span style="color: #ff4500;">0</span><span style="color: black;">&#41;</span> <span style="color: #808080; font-style: italic;"># Returns 1</span><br />&#160;<br />colors = myImage.<span style="color: black;">getXelVal</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">0</span>,<span style="color: #ff4500;">0</span><span style="color: black;">&#41;</span> <span style="color: #808080; font-style: italic;"># Returns (255,0,0)</span><br />colorVal = myImage.<span style="color: black;">getXel</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">0</span>,<span style="color: #ff4500;">0</span><span style="color: black;">&#41;</span> <span style="color: #808080; font-style: italic;"># Returns (1,0,0)</span></pre>
<p>The functions for setting pixel information  are <code>setRed(x,y,value), setGreen(x,y, value), setBlue(x,y, value)</code> or <code>setRedVal(x,y,value), setGreenVal(x,y, value), setBlueVal(x,y, value)</code>. Theres still the same dichotomy as above when it comes to regular sets and using setvals. You can also use <code>setXel(x,y,colorVec)</code> and <code>setXelVal(x,y, colorVec)</code>. You can also fill an image with a color by using <code>fill(r,g,b)</code> and <code>fillVal(r,g,b)</code>.
</p>
<pre class="python">myImage.<span style="color: black;">setGreenVal</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">0</span>, <span style="color: #ff4500;">0</span>, <span style="color: #ff4500;">255</span><span style="color: black;">&#41;</span> <span style="color: #808080; font-style: italic;"># If pixel (0,0) was red before, now it is yellow (255,255,0)</span><br />myImage.<span style="color: black;">setBlue</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">0</span>, <span style="color: #ff4500;">0</span>, <span style="color: #ff4500;">1</span><span style="color: black;">&#41;</span> <span style="color: #808080; font-style: italic;"># Pixel (0,0) is now white</span><br />&#160;<br />gray = Vec3<span style="color: black;">&#40;</span><span style="color: #ff4500;">0.5</span>, <span style="color: #ff4500;">0.5</span>, <span style="color: #ff4500;">0.5</span><span style="color: black;">&#41;</span><br />&#160;<br /><span style="color: #808080; font-style: italic;"># Both of these set the origin to gray</span><br />myImage.<span style="color: black;">setXelVal</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">0</span>, <span style="color: #ff4500;">0</span>, gray <span style="color: #66cc66;">*</span> <span style="color: #ff4500;">255</span><span style="color: black;">&#41;</span><br />myImage.<span style="color: black;">setXel</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">0</span>, <span style="color: #ff4500;">0</span>, gray<span style="color: black;">&#41;</span><br />&#160;<br /><span style="color: #808080; font-style: italic;"># Makes every pixel red</span><br />myImage.<span style="color: black;">fillVal</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">255</span>, <span style="color: #ff4500;">0</span>, <span style="color: #ff4500;">0</span><span style="color: black;">&#41;</span><br /><span style="color: #808080; font-style: italic;"># Makes every pixel green</span><br />myImage.<span style="color: black;">fill</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">0</span>, <span style="color: #ff4500;">1</span>, <span style="color: #ff4500;">0</span><span style="color: black;">&#41;</span></pre>
<p>There are also gets and sets for the alpha channel using the same interface as above. However, if you use them on an image that doesn't have an alpha channel you will cause a crash. To see if an image has an alpha channel use <code>hasAlpha()</code> which returns True if there is an alpha channel and False otherwise. You can add an alpha channel using <code>addAlpha()</code>. You can also remove it using <code>removeAlpha()</code>.
</p><p>You can also make an image grayscale by using <code>makeGrayscale()</code>. You can now use sets and gets for Gray too. Using <code>getGray*</code> on a color image just returns the value in the blue channel. If you want to get the grayscale value of a pixel regardless of whether the image is a grayscale or a color image, you can use <code>getBright(x,y)</code>, which works equally well on color or on grayscale images. If you want to weight the colors use <code>getBright(x,y, r,g,b)</code> where r,g,b are the weights for their respective channels.
</p><p>There are several other useful functions in the class this the API Reference for more information.
</p>
<h2> <span class="mw-headline" id="Getting_the_Image_of_a_Texture">Getting the Image of a Texture</span></h2>
<p>The Panda <code>Texture</code> class does not allow for pixel manipulation. However the <code>PNMImage</code> class below does. Therefore, if you want to change the image in a <code>Texture</code> object you must call its <code>store(myImage)</code> which saves the image of the texture into <code>myImage</code>.
</p>
<pre class="python">myImage = PNMImage<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><br />myTexture = loader.<span style="color: black;">loadTexture</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">&quot;myTex.jpg&quot;</span><span style="color: black;">&#41;</span><br />&#160;<br /><span style="color: #808080; font-style: italic;"># After this call, myImage now holds the same image as the texture</span><br />myTexture.<span style="color: black;">store</span><span style="color: black;">&#40;</span>myImage<span style="color: black;">&#41;</span></pre>
<h2> <span class="mw-headline" id="Loading_a_PNMImage_Into_a_Texture">Loading a PNMImage Into a Texture</span></h2>
<p>Once you have changed all the data in the image you can now load it into a texture using the <code>Texture</code> objects <code>load(myImage)</code> function, where <code>myImage</code> is the PNMImage to make the texture from.
</p>
<pre class="python"><span style="color: #808080; font-style: italic;"># Assume we already have myImage which is our modified PNMImage</span><br />myTexture=Texture<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><br />&#160;<br /><span style="color: #808080; font-style: italic;"># This texture now represents myImage</span><br />myTexture.<span style="color: black;">load</span><span style="color: black;">&#40;</span>myImage<span style="color: black;">&#41;</span></pre>
<p>Remember however, that most graphics cards require that the dimensions of  texture have to be a power of two. <code>PNMImage</code> does not have this restriction and Panda will not automatically scale the image when you put it into a texture.
</p>
<!-- 
NewPP limit report
Preprocessor node count: 389/1000000
Post-expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Expensive parser function count: 0/100
-->

<!-- Saved in parser cache with key mw_manual:pcache:idhash:1128-0!*!0!!*!*!* and timestamp 20130413155026 -->
</div><div style="width:100%; padding: 1px;" class=subnavigation>
<table width="640px" cellpadding="0" cellspacing="0" border="0">
              <tr>
              <td width="70px" align="left">&nbsp;&nbsp;<a style="text-decoration:none" href="More_about_GeomVertexReader,_GeomVertexWriter,_and_GeomVertexRewriter.html"><img border=0 width=16 height=16 src="arrow_left.png" align=absmiddle> <u>Prev</u></a></td>
              <td width="70px" align="center"><a style="text-decoration:none" href="Main_Page.html"><img border=0 width=16 height=16 src="arrow_up.png" align=absmiddle><u>Top</u></a></td>
              <td width="70px" align="right"><a style="text-decoration:none" href="Writing_3D_Models_out_to_Disk.html"><u>Next</u> <img border=0 width=16 height=16 src="arrow_right.png" align=absmiddle></a>&nbsp;&nbsp;</td>
              </tr></table></div><div id=legal>&copy; Carnegie Mellon University 2010</div></td></tr></table></td><td id=borderright></td></tr></table></td><td id=borderright></td></tr></table></body></html>